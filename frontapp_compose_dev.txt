version: '3.8'

services:
  frontapp-mcp:
    build:
      context: .
      dockerfile: Dockerfile
      target: builder
    container_name: frontapp-mcp-server-dev
    environment:
      - FRONTAPP_API_TOKEN=${FRONTAPP_API_TOKEN}
      - NODE_ENV=development
    restart: unless-stopped
    stdin_open: true
    tty: true
    volumes:
      # Mount source code for live development
      - ./src:/app/src:ro
      - ./dist:/app/dist
      # Use named volume for node_modules
      - node_modules:/app/node_modules
    command: sh -c "npm run watch"
    networks:
      - mcp-network
    labels:
      - "com.docker.compose.project=frontapp-mcp-dev"
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

volumes:
  node_modules:

networks:
  mcp-network:
    driver: bridge
